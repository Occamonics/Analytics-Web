(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[960],{75118:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/conversations",function(){return n(7917)}])},23761:function(e,t,n){"use strict";var i=n(83454),l=n(5121);let{BACKEND_ENDPOINT:s}=i.env,a=l.Z.create({baseURL:null!=s?s:"http://localhost:4000"});t.Z=a},7917:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return conversations}});var i,l,s,a,r,o,c=n(85893),u=n(67294),h=n(68672),d=n(65400),k=n.n(d),m=n(5789),S=n(74253),_=n(11187),f=n(55673),p=n(74048),g=n(20838),v=n(28465),y=n(51024),T=n(64749),x=n(2307),I=n(24342),b=n(46403),R=n(37656);let formatUnixTimestamp=e=>{let t=new Date(e),n=("0"+t.getDate()).slice(-2),i=("0"+(t.getMonth()+1)).slice(-2),l=t.getFullYear(),s=("0"+t.getHours()).slice(-2),a=("0"+t.getMinutes()).slice(-2);return n+"-"+i+"-"+l+" "+s+":"+a};function calculateResolutionRate(e){let t={Incorrect:0,Satisfactory:0,"Needs Improvement":0};for(let n=0;n<e.length;n++)e[n].result&&t[e[n].result]++;let n=e.length;return{Incorrect:t.Incorrect/n*100,Satisfactory:t.Satisfactory/n*100,"Needs Improvement":t["Needs Improvement"]/n*100}}let getResolutionByIntent=e=>{let t=[];e.forEach(e=>{let n=t.findIndex(t=>e.INTENT===t);e.INTENT&&-1===n&&t.push(e.INTENT)});let n=[];return t.forEach(t=>{let i=e.filter(e=>e.INTENT===t).length,l=e.filter(e=>e.INTENT===t&&"Satisfactory"===e.result).length,s=e.filter(e=>e.INTENT===t&&"Satisfactory"!==e.result).length;n.push({intent:t,sum:i,satisfactory:l,unsatisfactory:s})}),n},getReturnedUsers=e=>{let t=e.map(e=>({userId:e.USER_ID.replace(/_.*/,""),timestamp:e.TIMESTAMP}));t.sort((e,t)=>e.timestamp-t.timestamp);let n=[],i={},l={},s={},a={};for(let e=0;e<t.length;e++){let r=new Date(t[e].timestamp);r.setHours(0,0,0,0);let o=function(e){let t=""+e.getDate(),n=e.toLocaleString("default",{month:"short"});return e.getFullYear(),[t,n].join(" ")}(r);void 0===l[o]&&(l[o]=n.length,n.push({date:o,firstTimeLogin:0,repeatedLogin:0,returnedLogin:0,totalLogins:0})),i[t[e].userId]?s[t[e].userId]===o&&t[e].timestamp-a[t[e].userId]>=36e5?(n[l[o]].repeatedLogin++,a[t[e].userId]=t[e].timestamp):s[t[e].userId]!==o&&(s[t[e].userId]=o,a[t[e].userId]=t[e].timestamp,n[l[o]].returnedLogin++,n[l[o]].totalLogins++):(i[t[e].userId]=!0,s[t[e].userId]=o,a[t[e].userId]=t[e].timestamp,n[l[o]].firstTimeLogin++,n[l[o]].totalLogins++)}return{labels:n.map(e=>e.date),firstTimeData:n.map(e=>e.firstTimeLogin),returnedData:n.map(e=>e.returnedLogin)}},getSessionsPerCountry=e=>{let t=e.map(e=>e.country),n=t.reduce((e,t)=>(e[t]=(e[t]||0)+1,e),{}),i=Object.entries(n).map(e=>{let[t,n]=e;return{country:t,count:n}});return{countries:t,sessions:i}};var conversationTimeLine=e=>{let{conversation:t}=e,n=[];return t.forEach(e=>{n.push({label:formatUnixTimestamp(e.TIMESTAMP),children:(0,c.jsx)("p",{dangerouslySetInnerHTML:{__html:e.USER.replace(/\n/g,"<br/>")}}),color:"blue",dot:(0,c.jsx)(b.Z,{})}),n.push({label:formatUnixTimestamp(e.TIMESTAMP),children:(0,c.jsx)("p",{dangerouslySetInnerHTML:{__html:e.BOT.replace(/\n/g,"<br/>")}}),color:"green",dot:(0,c.jsx)(I.Z,{})})}),(0,c.jsx)("div",{children:(0,c.jsx)(R.Z,{mode:"left",items:n})})};function TextDisplay(e){let{text:t,maxWordsPerLine:n}=e,i=function(e,t){let n=e.split(" "),i=[];for(let e=0;e<n.length;e+=t)i.push(n.slice(e,e+t).join(" "));return i}(t,n);return(0,c.jsx)("div",{children:i.map((e,t)=>(0,c.jsxs)(u.Fragment,{children:[e,(0,c.jsx)("br",{})]},t))})}var userUtteranceDisplay=e=>{let{text:t,maxWordsPerLine:n}=e;return(0,c.jsx)(TextDisplay,{text:t,maxWordsPerLine:n})};(i=a||(a={})).COMPLETED="Completed",i.IN_PROGRESS="In Progress",i.WONT_FIX="Won't Fix",i.TO_DISCUSS="To Discuss",(l=r||(r={})).SATISFACTORY="Satisfactory",l.NEEDS_IMPROVEMENT="Needs Improvement",l.INCORRECT="Incorrect",(s=o||(o={})).RESPONSE_TEXT="Response Text",s.INTENT_MAPPING="Intent Mapping",s.FOLLOW_UP="Follow Up",s.ADD_INTENT="New Intent";var w=JSON.parse('[{"skill":null,"intent":null},{"skill":"FAQsDemo","intent":"faq.ans.clearReview.access"},{"skill":"FAQsDemo","intent":"faq.ans.clearReview.attachments"},{"skill":"FAQsDemo","intent":"faq.ans.clearReview.notifications"},{"skill":"FAQsDemo","intent":"faq.ans.clearReview.recording"},{"skill":"FAQsDemo","intent":"faq.ans.endOfYear.anonymousFeedback"},{"skill":"FAQsDemo","intent":"faq.ans.endOfYear.ratingNewJoiners"},{"skill":"FAQsDemo","intent":"faq.ans.endOfYear.ratingWeight"},{"skill":"FAQsDemo","intent":"faq.ans.endOfYear.values"},{"skill":"FAQsDemo","intent":"faq.ans.feedback.proactively"},{"skill":"FAQsDemo","intent":"faq.ans.feedback.request"},{"skill":"FAQsDemo","intent":"faq.ans.goal.manager.cascadeTeam"},{"skill":"FAQsDemo","intent":"faq.ans.goals.indirectReport"},{"skill":"Sch_Absence_Policies","intent":"buyAndSell"},{"skill":"Sch_Absence_Policies","intent":"cancelLeave"},{"skill":"Sch_Absence_Policies","intent":"carryOver"},{"skill":"Sch_Absence_Policies","intent":"juryService"},{"skill":"Sch_Absence_Policies","intent":"leaveBalanceWrong"},{"skill":"Sch_Absence_Policies","intent":"maternityLeave"},{"skill":"Sch_Absence_Policies","intent":"militaryService"},{"skill":"Sch_Absence_Policies","intent":"paidLeave"},{"skill":"Sch_Absence_Policies","intent":"paternityLeave"},{"skill":"Sch_Absence_Policies","intent":"sabbaticalLeave"},{"skill":"Sch_Absence_Policies","intent":"sickLeave"},{"skill":"Sch_Absence_Policies","intent":"specialLeave"},{"skill":"Sch_Absence_Policies","intent":"statutoryHolidays"},{"skill":"Sch_Approvals","intent":"Approval Actions"},{"skill":"Sch_Approvals","intent":"Task Submission Status"},{"skill":"Sch_Benefits","intent":"benefitOptionUnavailable"},{"skill":"Sch_Benefits","intent":"benefitsOffered"},{"skill":"Sch_Benefits","intent":"changeMyBenefits"},{"skill":"Sch_Benefits","intent":"dependents"},{"skill":"Sch_Benefits","intent":"healthAssessment"},{"skill":"Sch_Benefits","intent":"healthInsuranceProvider"},{"skill":"Sch_Benefits","intent":"optionsSelectionPeriod"},{"skill":"Sch_Benefits","intent":"pensionTransferring"},{"skill":"Sch_Benefits","intent":"pensions"},{"skill":"Sch_Benefits","intent":"pensionsForLeavers"},{"skill":"Sch_Benefits","intent":"sabbatical"},{"skill":"Sch_Benefits","intent":"viewMyBenefits"},{"skill":"Sch_Custom","intent":"absence.create.self"},{"skill":"Sch_Custom","intent":"expenses.deepLink"},{"skill":"Sch_Custom","intent":"feedback.negative"},{"skill":"Sch_Custom","intent":"feedback.positive"},{"skill":"Sch_Custom","intent":"feedback.suggestion"},{"skill":"Sch_Custom","intent":"impersonate.testUser"},{"skill":"Sch_Custom","intent":"oda.howToMove"},{"skill":"Sch_Custom","intent":"payslip.view.self"},{"skill":"Sch_Custom","intent":"personNumber.view.self"},{"skill":"Sch_Custom","intent":"timeSheet.manage.self"},{"skill":"Sch_HR_Policies","intent":"P60"},{"skill":"Sch_HR_Policies","intent":"POE"},{"skill":"Sch_HR_Policies","intent":"deferredQueries"},{"skill":"Sch_HR_Policies","intent":"diversityProfile"},{"skill":"Sch_HR_Policies","intent":"dutyOfCare"},{"skill":"Sch_HR_Policies","intent":"finance.helpdesk"},{"skill":"Sch_HR_Policies","intent":"finance.issue"},{"skill":"Sch_HR_Policies","intent":"generalEnquiries"},{"skill":"Sch_HR_Policies","intent":"helpdesk"},{"skill":"Sch_HR_Policies","intent":"hrPolicies"},{"skill":"Sch_HR_Policies","intent":"internalVacancies"},{"skill":"Sch_HR_Policies","intent":"overtime"},{"skill":"Sch_HR_Policies","intent":"password"},{"skill":"Sch_HR_Policies","intent":"performance"},{"skill":"Sch_HR_Policies","intent":"performanceFeedback"},{"skill":"Sch_HR_Policies","intent":"performanceGoals"},{"skill":"Sch_HR_Policies","intent":"referralSchema"},{"skill":"Sch_HR_Policies","intent":"resign"},{"skill":"Sch_HR_Policies","intent":"sendsafely"},{"skill":"Sch_HR_Policies","intent":"tax"},{"skill":"Sch_HR_Policies","intent":"techlink"},{"skill":"Sch_HR_Policies","intent":"travelPolicy"},{"skill":"Sch_HR_Policies","intent":"whistleblow"},{"skill":"Sch_HcmV2","intent":"absenceForDuration.view.self"},{"skill":"Sch_HcmV2","intent":"absenceFuture.view.self"},{"skill":"Sch_HcmV2","intent":"absencePast.view.self"},{"skill":"Sch_HcmV2","intent":"assignment.add.others"},{"skill":"Sch_HcmV2","intent":"assignment.manage.others"},{"skill":"Sch_HcmV2","intent":"assignment.manage.self"},{"skill":"Sch_HcmV2","intent":"assignment.view.self"},{"skill":"Sch_HcmV2","intent":"contactInfo.manage.others"},{"skill":"Sch_HcmV2","intent":"contactInfo.manage.self"},{"skill":"Sch_HcmV2","intent":"department.manage.self"},{"skill":"Sch_HcmV2","intent":"department.view.self"},{"skill":"Sch_HcmV2","intent":"directReports.manage.self"},{"skill":"Sch_HcmV2","intent":"email.manage.other"},{"skill":"Sch_HcmV2","intent":"email.view.self"},{"skill":"Sch_HcmV2","intent":"emergencyContacts.manage.others"},{"skill":"Sch_HcmV2","intent":"emergencyContacts.manage.self"},{"skill":"Sch_HcmV2","intent":"emergencyContacts.view.others"},{"skill":"Sch_HcmV2","intent":"emergencyContacts.view.self"},{"skill":"Sch_HcmV2","intent":"hire.worker"},{"skill":"Sch_HcmV2","intent":"hiredate.manage.others"},{"skill":"Sch_HcmV2","intent":"hiredate.manage.self"},{"skill":"Sch_HcmV2","intent":"hiredate.view.others"},{"skill":"Sch_HcmV2","intent":"hiredate.view.self"},{"skill":"Sch_HcmV2","intent":"job.manage.others"},{"skill":"Sch_HcmV2","intent":"job.manage.self"},{"skill":"Sch_HcmV2","intent":"job.view.self"},{"skill":"Sch_HcmV2","intent":"location.manage.other"},{"skill":"Sch_HcmV2","intent":"location.view.self"},{"skill":"Sch_HcmV2","intent":"manager.actions"},{"skill":"Sch_HcmV2","intent":"manager.manage.others"},{"skill":"Sch_HcmV2","intent":"manager.manage.self"},{"skill":"Sch_HcmV2","intent":"manager.view.self"},{"skill":"Sch_HcmV2","intent":"nickname.manage.others"},{"skill":"Sch_HcmV2","intent":"nickname.manage.self"},{"skill":"Sch_HcmV2","intent":"nickname.view.self"},{"skill":"Sch_HcmV2","intent":"onboarding.view.others"},{"skill":"Sch_HcmV2","intent":"paymentMethod.view.self"},{"skill":"Sch_HcmV2","intent":"payslip.view.others"},{"skill":"Sch_HcmV2","intent":"personalInfo.manage.self"},{"skill":"Sch_HcmV2","intent":"phone.manage.other"},{"skill":"Sch_HcmV2","intent":"phone.manage.self"},{"skill":"Sch_HcmV2","intent":"phone.view.self"},{"skill":"Sch_HcmV2","intent":"photo.manage.others"},{"skill":"Sch_HcmV2","intent":"photo.view.others"},{"skill":"Sch_HcmV2","intent":"photo.view.self"},{"skill":"Sch_HcmV2","intent":"representatives.manage.others"},{"skill":"Sch_HcmV2","intent":"representatives.manage.self"},{"skill":"Sch_HcmV2","intent":"salary.manage.others"},{"skill":"Sch_HcmV2","intent":"salary.manage.self"},{"skill":"Sch_HcmV2","intent":"salary.view.self"},{"skill":"Sch_HcmV2","intent":"taxDocuments.view.others"},{"skill":"Sch_HcmV2","intent":"terminate.worker"},{"skill":"Sch_HcmV2","intent":"transfer.worker"},{"skill":"Sch_HcmV2","intent":"workingHours.manage.others"},{"skill":"Sch_Hcm_Overrides","intent":"absenceBalance.view.others"},{"skill":"Sch_Hcm_Overrides","intent":"absenceBalance.view.self"},{"skill":"Sch_Hcm_Overrides","intent":"absenceForDuration.view.others"},{"skill":"Sch_Hcm_Overrides","intent":"absenceFuture.view.others"},{"skill":"Sch_Hcm_Overrides","intent":"absencePast.view.others"},{"skill":"Sch_Hcm_Overrides","intent":"assignment.view.other"},{"skill":"Sch_Hcm_Overrides","intent":"contactInfo.view.others"},{"skill":"Sch_Hcm_Overrides","intent":"contactInfo.view.self"},{"skill":"Sch_Hcm_Overrides","intent":"department.view.others"},{"skill":"Sch_Hcm_Overrides","intent":"directReports.view.others"},{"skill":"Sch_Hcm_Overrides","intent":"directReports.view.self"},{"skill":"Sch_Hcm_Overrides","intent":"email.manage.self"},{"skill":"Sch_Hcm_Overrides","intent":"email.view.other"},{"skill":"Sch_Hcm_Overrides","intent":"job.view.other"},{"skill":"Sch_Hcm_Overrides","intent":"location.manage.self"},{"skill":"Sch_Hcm_Overrides","intent":"location.view.others"},{"skill":"Sch_Hcm_Overrides","intent":"manager.view.others"},{"skill":"Sch_Hcm_Overrides","intent":"phone.view.other"},{"skill":"Sch_Hcm_Overrides","intent":"photo.manage.self"},{"skill":"Sch_Hcm_Overrides","intent":"representatives.view.others"},{"skill":"Sch_Hcm_Overrides","intent":"representatives.view.self"},{"skill":"Sch_Hcm_Overrides","intent":"salary.view.others"},{"skill":"Sch_Skills_and_Qualifications","intent":"careerCoaches"},{"skill":"Sch_Skills_and_Qualifications","intent":"cfaAndFitchLearning"},{"skill":"Sch_Skills_and_Qualifications","intent":"examReSits"},{"skill":"Sch_Skills_and_Qualifications","intent":"executiveAndAdvancedEducation"},{"skill":"Sch_Skills_and_Qualifications","intent":"mandatoryLearning.others"},{"skill":"Sch_Skills_and_Qualifications","intent":"mandatoryLearning.self"},{"skill":"Sch_Skills_and_Qualifications","intent":"membershipAndSubscriptions"},{"skill":"Sch_Skills_and_Qualifications","intent":"mentoring"},{"skill":"Sch_Skills_and_Qualifications","intent":"professionalQualificationSponsorship"},{"skill":"Sch_Skills_and_Qualifications","intent":"studyLeave"},{"skill":"Sch_Skills_and_Qualifications","intent":"teamDevelopmentDays"},{"skill":"Sch_Spark","intent":"authenticationSpark"},{"skill":"Sch_Spark","intent":"bookCourse"},{"skill":"Sch_Spark","intent":"cdp"},{"skill":"Sch_Spark","intent":"howToUseSpark"},{"skill":"Sch_Spark","intent":"informationContact"},{"skill":"Sch_Spark","intent":"managementCourses"},{"skill":"Sch_Spark","intent":"payment"},{"skill":"Sch_Spark","intent":"pendingRequestSpark"},{"skill":"Sch_Welfare","intent":"employeeAssistanceProgram"},{"skill":"Sch_Welfare","intent":"eyeCareVoucher"},{"skill":"Sch_Welfare","intent":"mentalHealth"},{"skill":"Sch_Welfare","intent":"onsiteDoctor"},{"skill":"SmallTalk","intent":"SMALLTALK_RichMessage"},{"skill":"SmallTalk","intent":"answer.date"},{"skill":"SmallTalk","intent":"answer.goodbye"},{"skill":"SmallTalk","intent":"answer.howAreYou"},{"skill":"SmallTalk","intent":"answer.human"},{"skill":"SmallTalk","intent":"answer.jokes"},{"skill":"SmallTalk","intent":"answer.meaningOfLife"},{"skill":"SmallTalk","intent":"answer.time"},{"skill":"SmallTalk","intent":"answer.weather"},{"skill":"SmallTalk","intent":"answer.whatsYourName"},{"skill":"UnresolvedHandler","intent":"unresolvedIntent"}]');let{TextArea:H}=y.default,filterOption=(e,t)=>{var n;return(null!==(n=null==t?void 0:t.label)&&void 0!==n?n:"").toLowerCase().includes(e.toLowerCase())};var conversationDesign=e=>{let{analysis:t,updateHandler:n,updateFilteredConversation:i}=e,l=[{title:"Key",key:"key",dataIndex:"key",filters:t.map(e=>({text:e.key.toString(),value:e.key})),filterSearch:!0,onFilter:(e,t)=>t.key==e},{title:"Country",key:"country",dataIndex:"country",sorter:(e,t)=>e.country.localeCompare(t.country),filters:t.filter((e,t,n)=>n.findIndex(t=>t.country===e.country)===t).map(e=>({text:e.country,value:e.country})),filterSearch:!0,onFilter:(e,t)=>t.country.includes(e),width:100},{title:"User ID",key:"USER_ID",dataIndex:"USER_ID",sorter:(e,t)=>e.USER_ID.localeCompare(t.USER_ID),render:e=>e.replace(/_.*/,""),filters:t.filter((e,t,n)=>n.findIndex(t=>t.USER_ID===e.USER_ID)===t).map(e=>({text:e.USER_ID.replace(/_.*/,""),value:e.USER_ID})),filterSearch:!0,onFilter:(e,t)=>t.USER_ID.includes(e),width:150},{title:"User Utterance",key:"USER_UTTERANCE",dataIndex:"USER_UTTERANCE",sorter:(e,t)=>e.USER_UTTERANCE.localeCompare(t.USER_UTTERANCE),render:e=>(0,c.jsx)(userUtteranceDisplay,{text:e,maxWordsPerLine:6})},{title:"Intent",key:"INTENT",dataIndex:"INTENT",sorter:(e,t)=>e.INTENT.localeCompare(t.INTENT),filters:t.filter((e,t,n)=>n.findIndex(t=>t.SKILL===e.SKILL&&t.INTENT===e.INTENT)===t).map(e=>({text:e.INTENT,value:e.INTENT})),filterSearch:!0,onFilter:(e,t)=>t.INTENT.includes(e)},{title:"Skill",key:"SKILL",dataIndex:"SKILL",sorter:(e,t)=>e.INTENT.localeCompare(t.INTENT),filters:t.filter((e,t,n)=>n.findIndex(t=>t.SKILL===e.SKILL)===t).map(e=>({text:e.SKILL,value:e.SKILL})),filterSearch:!0,onFilter:(e,t)=>t.SKILL.includes(e)},{title:"TIMESTAMP",key:"TIMESTAMP",dataIndex:"TIMESTAMP",sorter:(e,t)=>e.TIMESTAMP-t.TIMESTAMP,render:e=>formatUnixTimestamp(e)},{title:"Result",key:"result",dataIndex:"result",render:(e,t)=>(0,c.jsx)(T.default,{value:e,showSearch:!0,placeholder:"result",filterOption:filterOption,options:Object.entries(r).map(e=>{let[t,n]=e;return{label:n,value:n}}),onChange:e=>n(t.key,"result",e)}),filters:Object.entries(r).map(e=>{let[t,n]=e;return{text:n,value:n}}),filterSearch:!0,onFilter:(e,t)=>t.result&&t.result.includes(e)},{title:"Issue Type",key:"issue_type",dataIndex:"issue_type",render:(e,t)=>(0,c.jsx)(T.default,{showSearch:!0,placeholder:"issue type",filterOption:filterOption,options:Object.entries(o).map(e=>{let[t,n]=e;return{label:n,value:n}}),onChange:e=>{n(t.key,"issue_type",e)},disabled:t.result==r.SATISFACTORY,value:e}),filters:Object.entries(o).map(e=>{let[t,n]=e;return{text:n,value:n}}),filterSearch:!0,onFilter:(e,t)=>t.issue_type&&t.issue_type.includes(e)||!1},{title:"User Intent",key:"user_intent",dataIndex:"user_intent",render:(e,t)=>t.result==r.SATISFACTORY?(0,c.jsx)("div",{children:e}):(0,c.jsx)(T.default,{showSearch:!0,placeholder:"select user intent",value:e,onChange:e=>{n(t.key,"user_intent",e)},options:w.map(e=>({label:e.intent,value:e.intent}))})},{title:"Associated Skill",key:"associated_skill",dataIndex:"associated_skill",width:200},{title:"Status",key:"status",dataIndex:"status",render:(e,t)=>(0,c.jsx)(T.default,{showSearch:!0,defaultValue:a.IN_PROGRESS,placeholder:"status",filterOption:filterOption,options:Object.entries(a).map(e=>{let[t,n]=e;return{label:n,value:n}}),onChange:e=>{n(t.key,"status",e)},disabled:t.result==r.SATISFACTORY,value:e}),filters:Object.entries(a).map(e=>{let[t,n]=e;return{text:n,value:n}}),filterSearch:!0,onFilter:(e,t)=>t.status&&t.status.includes(e)},{title:"Notes",key:"notes",dataIndex:"notes",render:(e,t)=>(0,c.jsx)(H,{rows:1,value:e,onChange:e=>n(t.key,"notes",e.target.value)}),fixed:"right"}];return(0,c.jsx)(x.Z,{rowClassName:(e,t)=>{if(e.status&&e.result&&e.result!==r.SATISFACTORY){if(e.status===a.WONT_FIX)return"red-row";if(e.status===a.COMPLETED)return"green-row";if(e.status===a.IN_PROGRESS)return"yellow-row"}return""},columns:l,dataSource:t,scroll:{x:"max-content",y:"max-content",scrollToFirstRowOnChange:!0},expandable:{expandedRowRender:e=>(0,c.jsx)(conversationTimeLine,{conversation:e.conversation})},onChange:(e,t,n,l)=>{let{currentDataSource:s}=l;i(s)}})},E=n(34212),C=n(29790),N=n(30744),P=n(65132),j=n(32615);let O=[{title:"Skill",dataIndex:"skill",key:"skill",sorter:(e,t)=>e.skill.localeCompare(t.skill)},{title:"Intent",dataIndex:"intent",key:"intent",sorter:(e,t)=>e.intent.localeCompare(t.intent)}];var references=e=>{let{data:t}=e;return(0,c.jsx)(x.Z,{columns:O,dataSource:t,scroll:{y:"max-content"}})};n(23761);var L=n(11163),A=n(84105),D=n(24772),V=n(93162),U=n(96486);let handleExportClick=e=>{if(!e)return;let t=e.map(e=>{let t="";e.conversation.forEach(e=>{t+="USER:\n"+e.USER+"\n-----------\nBOT:\n"+e.BOT+"\n-----------\n"});let n=formatUnixTimestamp(e.TIMESTAMP);return{...e,dialogue:t,TS:n}}),n=["key","USER_ID","USER_UTTERANCE","INTENT","TS","BOT_NAME","CHANNEL_SESSION_ID","result","issue_type","notes","dialogue","status","country"],i=U.map(t,e=>U.pick(e,n)),l=A.P6.json_to_sheet(i);for(let e=2;e<=i.length;e++){let t="C"+e;l[t]&&(l[t].c=[{a:"Occamonics",t:i[e-2].dialogue}])}let s=A.P6.book_new();A.P6.book_append_sheet(s,l,"Sheet1");let a=A.cW(s,{bookType:"xlsx",type:"array"}),r=new Blob([a],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});(0,V.saveAs)(r,"data.xlsx")};var excelExportButton=e=>{let{data:t}=e;return(0,c.jsx)(k(),{onClick:()=>handleExportClick(t),style:{float:"right"},icon:(0,c.jsx)(D.Z,{}),className:"excel-export-button"})},F=n(23148),M=n(26495);F.kL.register(F.qi,F.u,F.De);var resolutionRate=e=>{let{resultPercentages:t}=e,n=[],i=[];for(let e in t)n.push(e),i.push(t[e]);return(0,c.jsx)("div",{style:{height:"90vh",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,c.jsx)(M.$I,{data:{labels:n,datasets:[{label:"percentage",data:i,backgroundColor:["rgba(255, 99, 132, 0.2)","rgba(75, 192, 192, 0.2)","rgba(255, 159, 64, 0.2)"],borderColor:["rgba(255, 99, 132, 1)","rgba(75, 192, 192, 1)","rgba(255, 159, 64, 1)"],borderWidth:1}]},style:{},options:{tooltips:{enabled:!1},plugins:{datalabels:{formatter:(e,t)=>{let n=0;return t.chart.data.datasets[0].data.map(e=>{n+=e}),(100*e/n).toFixed(2)+"%"},color:"#000000"}}}})})};F.kL.register(F.uw,F.f$,F.ZL,F.Dx,F.u,F.De);let B={responsive:!0,scales:{x:{stacked:!0},y:{stacked:!0}}};var topIntents=e=>{let{intentsResolution:t}=e,n=t.sort((e,t)=>t.sum-e.sum).slice(0,7),i=n.map(e=>e.intent),l={labels:i,datasets:[{label:"Satisfactory",data:n.map(e=>e.satisfactory),backgroundColor:"rgba(54, 162, 235, 0.2)",borderColor:"rgba(54, 162, 235, 1)",stack:"Stack 0"},{label:"Incorrect",data:n.map(e=>e.unsatisfactory),backgroundColor:"rgba(255, 99, 132, 0.2)",borderColor:"rgba(255, 99, 132, 1)",stack:"Stack 0"}]};return(0,c.jsx)(M.$Q,{options:B,data:l})},Q=n(64713);F.kL.register(F.uw,F.f$,F.od,F.jn,F.Dx,F.u,F.De);let Z={responsive:!0,scales:{x:{title:{display:!0,text:"Date"}},y:{title:{display:!0,text:"Number of Users"}}}};function ReturnedUsers(e){let{userReturns:t}=e,[n,i]=(0,u.useState)("bars");console.log(t);let l={labels:t.labels,datasets:[{label:"First Time",data:t.firstTimeData,backgroundColor:"rgba(54, 162, 235, 0.2)",borderColor:"rgba(54, 162, 235, 1)",stack:"stack 1"},{label:"Returned",data:t.returnedData,borderColor:"rgb(99,255,107)",backgroundColor:"rgba(128,255,99,0.5)",stack:"stack 1"}]};return(0,c.jsxs)("div",{children:[(0,c.jsxs)(Q.default.Group,{value:n,onChange:e=>i(e.target.value),children:[(0,c.jsx)(Q.default.Button,{value:"lines",children:"Lines"}),(0,c.jsx)(Q.default.Button,{value:"bars",children:"Bars"})]}),"lines"==n?(0,c.jsx)(M.x1,{options:Z,data:l}):(0,c.jsx)(M.$Q,{options:Z,data:l})]})}F.kL.register(F.uw,F.f$,F.ZL,F.Dx,F.u,F.De);var sessionsPerCountry=e=>{let{spc:t}=e,n=t.sessions.sort((e,t)=>t.count-e.count).map(e=>e.country),i={labels:n,datasets:[{label:"Number of Sessions",data:t.sessions.sort((e,t)=>t.count-e.count).map(e=>e.count),backgroundColor:"rgba(54, 162, 235, 0.2)",borderColor:"rgba(54, 162, 235, 1)"}]};return(0,c.jsx)(M.$Q,{data:i})},chartsDeck=e=>{let{data:t}=e;return(0,c.jsx)(g.default,{items:[{label:"Resolution",key:"1",children:(0,c.jsx)(resolutionRate,{resultPercentages:calculateResolutionRate(t)})},{label:"Top Intents",key:"2",children:(0,c.jsx)(topIntents,{intentsResolution:getResolutionByIntent(t)})},{label:"Return Visits",key:"3",children:(0,c.jsx)(ReturnedUsers,{userReturns:getReturnedUsers(t)})},{label:"Sessions Per Country",key:"4",children:(0,c.jsx)(sessionsPerCountry,{spc:getSessionsPerCountry(t)})},{label:"Percentage Per Country",key:"5",children:(0,c.jsx)(c.Fragment,{})}]})},conversations=()=>{let[e,t]=(0,u.useState)([]),[n,i]=(0,u.useState)([]),[l,s]=(0,u.useState)(null);(0,u.useEffect)(()=>{},[]);let handleRouteChange=(e,t)=>{let{shallow:n}=t;if(window.confirm("Are you sure you want to leave this page?"));else throw L.Router.events.emit("routeChangeError"),"Route cancelled."};return(0,u.useEffect)(()=>(L.Router.events.on("routeChangeStart",handleRouteChange),()=>{L.Router.events.off("routeChangeStart",handleRouteChange)}),[]),(0,c.jsxs)("div",{children:[(0,c.jsxs)(h.Z,{style:{margin:"16px 0"},children:[(0,c.jsx)(h.Z.Item,{children:"Conversations"}),(0,c.jsx)(h.Z.Item,{children:"Analytics"})]}),(0,c.jsx)(S.Z,{}),(0,c.jsxs)(f.Z,{children:[(0,c.jsx)(m.Z,{span:8,children:(0,c.jsxs)(p.default,{children:[(0,c.jsx)(v.Z,{beforeUpload:e=>{let t=new FileReader;return t.onload=e=>{try{let t=JSON.parse(e.target.result),l=t.concat(n);console.log(l),i(l.map((e,t)=>({...e,key:t}))),_.ZP.success("File uploaded successfully!")}catch(e){_.ZP.error("Error parsing JSON. Please upload a valid JSON file.")}},t.readAsText(e),!1},showUploadList:!1,accept:".json",children:(0,c.jsx)(k(),{icon:(0,c.jsx)(j.default,{})})}),(0,c.jsx)(k(),{icon:(0,c.jsx)(N.default,{}),onClick:()=>{if(n){let e=JSON.stringify(n,null,2),t=new Blob([e],{type:"application/json"}),i=URL.createObjectURL(t),l=document.createElement("a");l.href=i,l.download="analysis.json",l.click(),URL.revokeObjectURL(i)}else _.ZP.warning("No data to download. Please upload a JSON file first.")}})]})}),(0,c.jsx)(m.Z,{span:8,offset:8,children:(0,c.jsx)(excelExportButton,{data:l})})]}),(0,c.jsx)(S.Z,{dashed:!0}),(0,c.jsx)(g.default,{tabPosition:"right",items:[{key:"conversation_design",label:"",children:(0,c.jsx)(conversationDesign,{analysis:n,updateHandler:(e,t,l)=>{let s=[...n],o=s.findIndex(t=>t.key===e);-1!==o&&(s[o][t]=l),s[o].status||(s[o].status=a.IN_PROGRESS),s[o].result===r.SATISFACTORY&&(s[o].status=a.IN_PROGRESS,s[o].issue_type=null,s[o].user_intent=s[o].INTENT),s[o].INTENT===s[o].user_intent&&(s[o].associated_skill=s[o].SKILL);let c=w.find(e=>e.intent===s[o].user_intent);s[o].associated_skill=c?c.skill:null,i(s),console.log(calculateResolutionRate(s))},updateFilteredConversation:s}),icon:(0,c.jsx)(E.Z,{})},{key:"reference",label:"",children:(0,c.jsx)(references,{data:w.map((e,t)=>({...e,key:t}))}),icon:(0,c.jsx)(P.Z,{})},{key:"charts",label:"",children:(0,c.jsx)(chartsDeck,{data:n}),icon:(0,c.jsx)(C.default,{})}]})]})}},20067:function(){},72061:function(){}},function(e){e.O(0,[196,251,662,672,945,121,853,307,470,320,774,888,179],function(){return e(e.s=75118)}),_N_E=e.O()}]);